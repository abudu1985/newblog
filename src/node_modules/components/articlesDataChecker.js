import {useEffect, useContext} from 'react'
import {ArticlesDataContext} from 'contexts/articlesData'
import firebase from "../../firebase";

const CurrentUserChecker = ({children}) => {
    const [articlesData, dispatch] = useContext(ArticlesDataContext);

    useEffect(() => {
console.log(articlesData);
        if (articlesData.articles.length) return;

        firebase.getArticles().then(snapshot => {
            let midArr = [];
            snapshot.forEach(doc => {
                const obj = Object.assign({}, doc.data(), {id: doc.id});
                midArr.push(obj);
            });
            dispatch({type: 'GET_ARTICLES', payload: midArr})
        })
            .catch(error => {
                alert(error);
            });
    }, []);

    return children
};

export default CurrentUserChecker
